<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>barcode</title>
</head>
<!-- Bootstrap 5.3.0 alpha 1 -->
<link rel="stylesheet" href="dist/bootstrap-5.3.0-alpha1-dist/css/bootstrap.css">

<body>

    <div class="container-fluid">
        <div id="reader"></div>

        <div class="">
            <p>Результат сканирования:</p>
            <div id="text"></div>
            <div id="result"></div>
        </div>
    </div>


    текст
    <p id="text"></p>
    результат:
    <p id="result"></p>
</body>

<!-- Bootstrap 5.3.0 alpha 1 -->
<script src="dist/bootstrap-5.3.0-alpha1-dist/js/bootstrap.bundle.min.js"></script>

<!--  -->
<script src="js/html5-qrcode.min@2.3.4.js"></script>
<script>
    // 
    function onScanSuccess(decodedText, decodedResult) {
        document.getElementById('text').innerText = `${decodedText}`;
        document.getElementById('result').innerText = `${decodedResult.result.format.formatName}`;
        console.log(`Code matched = ${decodedText}`, decodedResult);
        // window.alert(decodedText);
    }

    // Square QR box with edge size = 70% of the smaller edge of the viewfinder.
    let qrboxFunction = function (viewfinderWidth, viewfinderHeight) {
        let minEdgePercentage = 0.4; // 70%
        let minEdgeSize = Math.min(viewfinderWidth, viewfinderHeight);
        let qrboxSize = Math.floor(minEdgeSize * minEdgePercentage);
        return {
            width: qrboxSize,
            height: qrboxSize
        };
    }

    let config = { fps: 10, qrbox: { width: 250, height: 250 } };
    let html5QrcodeScanner = new Html5QrcodeScanner(
        "reader", config, /* verbose= */ false);
    html5QrcodeScanner.render(onScanSuccess);

    // const config =
    // {
    //     fps: 8,
    //     qrbox: {
    //         width: 250,
    //         height: 250
    //     },
    //     rememberLastUsedCamera: true,
    //     disableFlip: true,
    //     aspectRatio: 1,
    //     facingMode: {
    //         exact: "environment"
    //     },
    //     focusMode: "continuous",
    //     supportedScanTypes: [
    //         Html5QrcodeScanType.SCAN_TYPE_CAMERA,
    //         Html5QrcodeScanType.SCAN_TYPE_FILE
    //     ],
    //     formatsToSupport: [
    //         Html5QrcodeSupportedFormats.QR_CODE
    //     ],
    //     showTorchButtonIfSupported: true,
    //     useBarCodeDetectorIfSupported: true,
    //     showZoomSliderIfSupported: true,
    //     defaultZoomValueIfSupported: 2
    // };

    // html5QrCode.start({ facingMode: "environment" }, config, qrCodeSuccessCallback);




    // let tbody = document.getElementById(tableBodyId);
    // let trow = document.createElement('tr');
    // let td1 = document.createElement('td');
    // td1.innerText = `${codeId}`;
    // let td2 = document.createElement('td');
    // td2.innerText = `${decodedResult.result.format.formatName}`;
    // let td3 = document.createElement('td');
    // td3.innerText = `${decodedText}`;

    // docReady(function () {
    //     hljs.initHighlightingOnLoad();
    //     var lastMessage;
    //     function onScanSuccess(decodedText, decodedResult) {
    //         if (lastMessage !== decodedText) {
    //             lastMessage = decodedText;
    //             document.getElementById('text').innerText = decodedText;
    //             document.getElementById('result').innerText = decodedResult;
    //         }
    //     }

    //     var qrboxFunction = function (viewfinderWidth, viewfinderHeight) {
    //         // Square QR Box, with size = 80% of the min edge.
    //         var minEdgeSizeThreshold = 250;
    //         var edgeSizePercentage = 0.75;
    //         var minEdgeSize = (viewfinderWidth > viewfinderHeight) ?
    //             viewfinderHeight : viewfinderWidth;
    //         var qrboxEdgeSize = Math.floor(minEdgeSize * edgeSizePercentage);
    //         if (qrboxEdgeSize < minEdgeSizeThreshold) {
    //             if (minEdgeSize < minEdgeSizeThreshold) {
    //                 return { width: minEdgeSize, height: minEdgeSize };
    //             } else {
    //                 return {
    //                     width: minEdgeSizeThreshold,
    //                     height: minEdgeSizeThreshold
    //                 };
    //             }
    //         }
    //         return { width: qrboxEdgeSize, height: qrboxEdgeSize };
    //     }
    //     let html5QrcodeScanner = new Html5QrcodeScanner(
    //         "reader",
    //         {
    //             fps: 10,
    //             qrbox: qrboxFunction,
    //             // Important notice: this is experimental feature, use it at your
    //             // own risk. See documentation in
    //             // mebjas@/html5-qrcode/src/experimental-features.ts
    //             experimentalFeatures: {
    //                 useBarCodeDetectorIfSupported: true
    //             },
    //             rememberLastUsedCamera: true,
    //             showTorchButtonIfSupported: true
    //         });
    //     html5QrcodeScanner.render(onScanSuccess);
    // });

</script>

</html>